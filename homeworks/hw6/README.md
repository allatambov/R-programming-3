Домашнее задание 6
================
Алла Тамбовцева

Формат сдачи
------------

*Срок сдачи:*

14 марта 2018, 22:00

*Формат сдачи:*

Результат выполнения домашнего задания 6: файл с расширением `.R`. Этот файл нужно загрузить по [ссылке](https://www.dropbox.com/request/nWpkCl4DIBSGb8V2YkwC). 


Базовый блок
----------------------

**Задача 1.** В переменной `sales_past` сохранено число продаж в прошлом году (одно число), в переменной `sales_current` сохранено число продаж в текущем году (одно число). Напишите код, который выводит на экран 

* "This salesperson is successful.", если число продаж в текущем году больше, чем в предыдущем
* "This salesperson is not successful.", если число продаж в текущем году не больше, чем в предыдущем.


**Задача 2.** В векторе `FH` сохранены значения индекса Freedom House для разных стран:

```
FH <- c(Albania = 3, Austria = 1, Bangladesh = 4, Romania = 2, Russia = 6, Chad = 6.5)
```

1) Напишите код, который выводит на экран каждый элемент вектора (элементы выводятся без названий стран, это нормально).

2) Напишите код, который выводит на экран каждый элемент вектора и добавляет (тоже выводит на экран) комментарии "This country is Free", "This country is Not Free", "This country is Partly Free" в зависимости от значения индекса Freedom House. Соответствие значений индекса типу страны -- см. в [таблице 3](https://freedomhouse.org/report/freedom-world-2016/methodology) в разделе Methodology на сайте Freedom House.

**Задача 3.** Напишите код, который работает следующим образом -- см. примеры [здесь](https://github.com/allatambov/R-programming-4/blob/master/homeworks/hw6/hw6.png).

*Примечание:* вместо слова "кот" может быть любой текст, отличный от слова "диплом" в разных регистрах (диплом, Диплом, ДИПЛОМ).


**Задача 4.** Напишите функцию `get_info` , которая принимает на вход базу данных и возвращает список (`list`, не вектор) из следующих векторов:

* вектор `dimensions` - содержит 2 элемента: число строк и столбцов в базе данных

* вектор `columns` - содержит названия столбцов в базе данных

* вектор `rows.na` - содержит номера строк, содержащих пропущенные значения

*Пример:*

```
> data
   A B  C
1 18 0  1
2 22 1  4
3 33 0  7
4 19 1 NA
5 45 0  9
6 NA 1  0
7 48 0  0
8 NA 1  1

> get_info(data)
$dimensions
[1] 8 3

$columns
[1] "A" "B" "C"

$rows.na
[1] 4 6 8

```


**Задача 5.** Напишите какую-нибудь "добрую" или "вредную" функцию, которая запрашивает у пользователя какую-то информацию и выводит на экран некоторый комментарий (текст) в зависимости от того, что ввел пользователь. Пример "доброй" функции - функция `welcome` с семинара, пример "вредной" функции - функция из задачи 3. 


**Задача 6.** Напишите функцию `outliers_ind`, которая принимает на вход числовой вектор и возвращает *индексы* нетипичных значений. Готовые функции R для определения нетипичных значений использовать нельзя (и вытаскивать их из `boxplot` тоже).

*Подсказка:* границы типичных значений определяются как [Q1 - 1.5 * IQ; Q3 + 1.5 * IQ], где

* Q1 - нижний квартиль, квантиль уровня 0.25; получить можно с помощью `quantile(my_vector, prob = 0.25)`

* Q3 - верхний квартиль, квантиль уровня 0.75; получить можно с помощью `quantile(my_vector, prob = 0.75)`

* IQ - межквартильный размах, вычисляется как Q3 - Q1

Соответственно, нетипичные значения - все те, которые меньше нижней границы типичных значений или которые больше верхней границы типичных значений.


Продвинутый блок
----------------------

**Задание 1.**

Напишите функцию, которая принимает на вход выборку (числовой вектор) и возвращает ее медиану. Готовые функции R (`median`, `summary`, `fivenum` и прочие) использовать нельзя. Если забыли, как определяется медиана и какие существуют тонкости ее вычисления - см., например, [здесь](https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D0%B4%D0%B8%D0%B0%D0%BD%D0%B0_(%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D0%BA%D0%B0)).

**Задание 2.**

Напишите функцию, которая принимает на вход выборку (числовой вектор) и возвращает взвешенное среднее значение, посчитанное по цензурированной выборке.

* Цензурированная выборка получается путем выкидывания из исходной выборки самого большого и самого маленького значения. 

* Веса для подсчета среднего определяются так: если значение является типичным, то его вес равен 0.7, а если нетипичным, то 0.3. Про типичные и нетипичные значения - см. задачу 6 из базового блока. Готовые функции R для определения нетипичных значений использовать нельзя (и вытаскивать их из `boxplot` тоже).

Пример для проверки своей функции:
```
v <- c(-120, -100, 18, 20, 22, 25, 26, 27, 28, 29, 98, 100, 120, 400, 500)
```

Взвешенное среднее по выборке `v` после цензурирования равно 54.10843.