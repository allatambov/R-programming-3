# Семинар 3. Базы данных.

Алла Тамбовцева 24 ноября 2017 г

**Часть 1**

1.  Поставьте библиотеку [randomNames](https://cran.r-project.org/web/packages/randomNames/randomNames.pdf). Обратитесь к ней через `library()`.

2.  Создайте вектор из 100 испанских имен:

``` r
set.seed(1234) # чтобы у всех получались одинаковые результаты
names <- randomNames(100, which.names = "first", ethnicity = 4) 
```

3.  Будем считать, что эти 100 имен -- имена опрошенных респондентов. Создайте вектор со значениями возраста респондентов:

``` r
ages <- sample(16:75, 100, replace = TRUE) # replace = TRUE - с повторяющимися значениями
```

А также вектор polit -- политические взгляды респондентов:

``` r
views <- c("right", "left", "moderate", "indifferent")
polit <- sample(views, 100, replace = TRUE)
```

Создайте из полученных трех векторов базу данных (воспользуйтесь функцией `as.data.frame()`).

-   Создайте столбец `id` с номерами респондентов.
-   Определите, сколько среди респондентов людей в возрасте от 25 до 30 лет (включительно). Определите, какую долю респондентов в нашей сымпровизированной выборке составляют люди в возрасте от 25 до 30 лет. Выразите эту долю в процентах, округлите ее до 1 знака после запятой.
-   Создайте "факторный" вектор политических взглядов `polit\_views`. Сколько у полученного фактора уровней? Добавьте в базу данных столбец `polit\_views`.

**Часть 2**

1. Загрузите файл с базой данных *Chile.csv*. Почитать про базу можно [здесь](https://www.rdocumentation.org/packages/car/versions/2.1-5/topics/Chile). Посмотрите на базу данных.

2. Сколько в базе данных наблюдений? Сколько переменных? Какие это переменные?

3. Сколько в базе данных полностью заполненных строк (наблюдений)? Выведите наблюдения, содержащие пропущенные значения на экран.

4. Отфильтруйте наблюдения в базе согласно следующим критериям:

* респонденты в возрасте от 18 до 35 лет (включительно)

* респонденты мужского пола, доход которых не превышает 35000

* респонденты женского пола, голосующие за Пиночета (Y), живущие в Сантьяго (SA)

5. Создайте переменную "возраст в квадрате" (age_sq) и добавьте ее в базу.

6. Создате переменную "натуральный логарифм дохода" (log_income) и добавьте ее в базу. 

7. Постройте график, который может проиллюстрировать, какие паттерны пропущенных наблюдений можно зафиксировать в базе данных.

8. Удалите пропущенные значения из базы данных.

9. Сохраните измененную базу данных в формате dta (файл "Chile.dta")
